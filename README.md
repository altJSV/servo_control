# Servo control
Управление нексолькими серво-приводами через Яндекс Алису и веб интерфейс

## Настройки
Укажите здесь учетные данные для подключения к вашей точке доступа WiFi
> //Логин- пароль wifi
> #define ssid  "ssid" //точка доступа wifi
> #define password  "pass" //пароль wifi

Далее учетные данные для подключения к MQTT брокеру
> //mqtt
> const char* mqtt_server = "192.168.1.1"; //ip или http адрес
> int mqtt_port = 1883; //порт
> const char* mqtt_login="login"; //логин
> const char* mqtt_pass="pass"; //пароль

Здесь укажите колличество подключенных сервоприводов и максимальный угол поворота (0-180) 
> #define AMOUNT 2 //количество сервоприводов
> #define MAXANGLE 90 //максимальный угол поворота

В функции Setup() укажите пины ESP8266 к которым подключены управляющие провода серво-приводов
> 	servos[0].attach(D3);
>   servos[0].smoothStart();
>   servos[1].attach(D4);
>   servos[1].smoothStart();
>   //servos[2].attach(5);
>   //servos[2].smoothStart();
>   //servos[3].attach(6);
>   //servos[3].smoothStart();

## Сборка проекта
Для корректной сборки используйте ядро ESP8266 для Arduino IDE верси не ниже 2.7.4 и библиотеки из папки libs проекта

## Веб интерфейс
При подключении к вашей сети WiFi ESP8266 поднимает веб интерфейс на 80 порту. IP адрес для подключения выводится в мониторе серийного порта Arduino IDE. Введите его в адресную строку вашего браузера.
В открывшемся веб интерфейсе выберите в выпадающем нужный вам сервопривод и спомощью ползунка установите угол поворота. Нажмите кнопку Применить для выполнения команды. Для управления всеми сервоприводами одновременно выберите в выпадающем списке пункт Все.

## Управление по MQTT
При подключении к MQTT брокеру устройство создает топик **StatusTopic** где публикует информацию о своем статусе. Также оно подписывается на топик **CmdTopic** для приема команд.

### Формат команд
Устройство понимает следующий формат команд:
**N DEG**
Где N - номер сервопривода от 0 до AMOUNT-1
DEG - угол поворота
При N=AMOUNT команда выполняется для всех серво одновременно

